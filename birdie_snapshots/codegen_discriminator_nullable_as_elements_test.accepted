---
version: 1.2.1
title: codegen_discriminator_nullable_as_elements_test
file: ./test/json_typedef_test.gleam
test_name: codegen_discriminator_nullable_as_elements_test
---
RootSchema(
  [],
  Elements(
    False,
    [],
    Discriminator(
      True,
      [],
      "kind",
      [
        #(
          "up",
          PropertiesSchema(
            [
              #(
                "height",
                Type(False, [], Uint8),
              ),
            ],
            [],
            False,
          ),
        ),
        #(
          "down",
          PropertiesSchema(
            [
              #(
                "depth",
                Type(False, [], Float32),
              ),
              #(
                "note",
                Type(True, [], String),
              ),
            ],
            [],
            False,
          ),
        ),
      ],
    ),
  ),
)

-----------------------------------------------------------

import decode
import gleam/json
import gleam/option

pub type DataElementdown {
  DataElementdown(
    depth: Float,
    note: String,
  )
}

pub type DataElementup {
  DataElementup(
    height: Int,
  )
}

pub fn data_decoder() -> decode.Decoder(List(option.Option(Data))) {
  decode.list(todo)
}

pub fn data_to_json(data: List(option.Option(Data))) -> json.Json {
  json.array(data, fn(data) { case data {
    option.Some(data) -> case data {
    Up(height:) -> json.object([
    #("kind", json.string("up")),
    #("height", json.int(height)),
  ])
    Down(depth:, note:) -> json.object([
    #("kind", json.string("down")),
    #("depth", json.float(depth)),
    #("note", json.nullable(note, json.string)),
  ])
  }
    option.None -> json.null()
  } })
}